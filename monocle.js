/* Monocle 0.9.6 | http://monocle.tapquo.com | Copyright (C) 2011,2012 Javi Jim√©nez Villar (@soyjavi) */
(function(){var m,l,i,h,g=[].slice,b=[].indexOf||function(c){for(var d=0,e=this.length;d<e;d++)if(d in this&&this[d]===c)return d;return-1},a={}.hasOwnProperty,f=function(c,d){function e(){this.constructor=c}for(var j in d)if(a.call(d,j))c[j]=d[j];e.prototype=d.prototype;c.prototype=new e;c.__super__=d.prototype;return c};m={bind:function(c,d){var e,j,k,n,o;j=c.split(" ");e=this.hasOwnProperty("_callbacks")&&this._callbacks||(this._callbacks={});n=0;for(o=j.length;n<o;n++){k=j[n];e[k]||(e[k]=[]);
e[k].push(d)}return this},trigger:function(){var c,d,e,j,k;c=1<=arguments.length?g.call(arguments,0):[];e=c.shift();if(e=this.hasOwnProperty("_callbacks")&&((d=this._callbacks)!=null?d[e]:void 0)){j=0;for(k=e.length;j<k;j++){d=e[j];if(d.apply(this,c)===false)break}return true}},unbind:function(c,d){var e,j,k,n,o;if(!c){this._callbacks={};return this}k=(e=this._callbacks)!=null?e[c]:void 0;if(!k)return this;if(!d){delete this._callbacks[c];return this}j=n=0;for(o=k.length;n<o;j=++n){e=k[j];if(e===
d){k=k.slice();k.splice(j,1);this._callbacks[c]=k;break}}return this}};h=["included","extended"];l=function(){function c(){typeof this.init==="function"&&this.init.apply(this,args)}c.include=function(d){var e,j;if(!d)throw Error("include(obj) requires obj");for(e in d){j=d[e];if(b.call(h,e)<0)this.prototype[e]=j}(d=d.included)&&d.apply(this);return this};c.extend=function(d){var e,j;if(!d)throw Error("extend(obj) requires obj");for(e in d){j=d[e];if(b.call(h,e)<0)this[e]=j}if((d=d.extended)!=null)d.apply(this);
return this};c.proxy=function(d){var e=this;return function(){return d.apply(e,arguments)}};c.prototype.proxy=function(d){var e=this;return function(){return d.apply(e,arguments)}};c.prototype.delay=function(d,e){return setTimeout(this.proxy(d),e||0)};return c}();i=this.Monocle={};i.version="0.9.4";i.Events=m;i.Module=l;i.Templates={};i.Dom=function(){var c;c=1<=arguments.length?g.call(arguments,0):[];return typeof $$!=="undefined"&&$$!==null?$$.apply(null,c):$.apply(null,c)};l.extend.call(i,m);l.create=
function(c,d){var e;e=function(j){function k(){return k.__super__.constructor.apply(this,arguments)}f(k,j);return k}(this);c&&e.include(c);d&&e.extend(d);typeof e.unbind==="function"&&e.unbind();return e};this.__=i.App={Model:{},View:{},Controller:{}};this.__Model=i.App.Model;this.__View=i.App.View;this.__Controller=i.App.Controller}).call(this);(function(){var m,l={}.hasOwnProperty,i=function(g,b){function a(){this.constructor=g}for(var f in b)if(l.call(b,f))g[f]=b[f];a.prototype=b.prototype;g.prototype=new a;g.__super__=b.prototype;return g},h=[].slice;Monocle.Model=function(g){function b(a){b.__super__.constructor.apply(this,arguments);this.className=this.constructor.name;a&&this.load(a);this.uid=this.constructor.uid()}i(b,g);b.extend(Monocle.Events);b.records={};b.attributes=[];b.fields=function(){var a;a=1<=arguments.length?h.call(arguments,
0):[];this.records={};if(a.length)this.attributes=a;this.attributes||(this.attributes=[]);this.unbind();return this};b.create=function(a){return(new this(a)).save()};b.uid=function(){return m()};b.exists=function(a){try{return this.find(a)}catch(f){return false}};b.find=function(a){a=this.records[a];if(!a)throw Error("Unknown record");return a.clone()};b.findBy=function(a,f){var c,d,e;e=this.records;for(d in e){c=e[d];if(c[a]===f)return c.clone()}throw Error("Unknown record");};b.select=function(a){var f,
c;return this.cloneArray(function(){var d,e;d=this.records;e=[];for(c in d){f=d[c];a(f)&&e.push(f)}return e}.call(this))};b.each=function(a){var f,c,d,e;d=this.records;e=[];for(f in d){c=d[f];e.push(a(c.clone()))}return e};b.all=function(){return this.cloneArray(this.recordsValues())};b.count=function(){return this.recordsValues().length};b.cloneArray=function(a){var f,c,d,e;e=[];c=0;for(d=a.length;c<d;c++){f=a[c];e.push(f.clone())}return e};b.recordsValues=function(){var a,f,c,d;f=[];d=this.records;
for(a in d){c=d[a];f.push(c)}return f};b.destroyAll=function(){return this.records={}};b.prototype.isNew=function(){return!this.exists()};b.prototype.exists=function(){return this.uid&&this.uid in this.constructor.records};b.prototype.clone=function(){return createObject(this)};b.prototype.load=function(a){var f,c;for(f in a){c=a[f];typeof this[f]==="function"&&this[f](c);this[f]=c}return this};b.prototype.attributes=function(){var a,f,c,d,e;f={};e=this.constructor.attributes;c=0;for(d=e.length;c<
d;c++){a=e[c];if(a in this)f[a]=typeof this[a]==="function"?this[a]():this[a]}return f};b.prototype.equal=function(a){return!!(a&&a.constructor===this.constructor&&a.uid&&a.uid===this.uid)};b.prototype.save=function(){var a;if(this.validate!=null)a=this.validate();if(a){this.trigger("error",a);return false}this.trigger("beforeSave");a=this.isNew()?this.create():this.update();this.trigger("save");return a};b.prototype.updateAttributes=function(a){this.load(a);return this.save()};b.prototype.changeUID=
function(a){var f;f=this.constructor.records;f[a]=f[this.uid];delete f[this.uid];this.uid=a;return this.save()};b.prototype.create=function(){var a;this.trigger("beforeCreate");a=new this.constructor(this.attributes());a.uid=this.uid;this.constructor.records[this.uid]=a;this.trigger("create");this.trigger("change","create");return a.clone()};b.prototype.update=function(){var a;this.trigger("beforeUpdate");a=this.constructor.records;a[this.uid].load(this.attributes());this.trigger("update");this.trigger("change",
"update");return a[this.uid].clone()};b.prototype.destroy=function(){this.trigger("beforeDestroy");delete this.constructor.records[this.uid];this.trigger("destroy");this.trigger("change","destroy");this.unbind();return this};b.prototype.clone=function(){return Object.create(this)};b.prototype.unbind=function(){return this.trigger("unbind")};b.prototype.trigger=function(){var a,f;a=1<=arguments.length?h.call(arguments,0):[];a.splice(1,0,this);return(f=this.constructor).trigger.apply(f,a)};return b}(Monocle.Module);
if(typeof Object.create!=="function")Object.create=function(g){var b;b=function(){};b.prototype=g;return new b};m=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(g){var b;b=Math.random()*16|0;return(g==="x"?b:b&3|8).toString(16)}).toUpperCase()}}).call(this);(function(){var m=function(h,g){return function(){return h.apply(g,arguments)}},l={}.hasOwnProperty,i=function(h,g){function b(){this.constructor=h}for(var a in g)if(l.call(g,a))h[a]=g[a];b.prototype=g.prototype;h.prototype=new b;h.__super__=g.prototype;return h};Monocle.Controller=function(h){function g(b){this.destroy=m(this.destroy,this);var a,f;if(typeof b==="string")this.el=Monocle.Dom(b);else for(a in b){f=b[a];this[a]=f}if(!this.el)this.el=Monocle.Dom(document.createElement(this.tag));if(!this.events)this.events=
this.constructor.events;if(!this.elements)this.elements=this.constructor.elements;this.events&&this.delegateEvents();this.elements&&this.refreshElements();g.__super__.constructor.apply(this,arguments)}i(g,h);g.include(Monocle.Events);g.prototype.eventSplitter=/^(\S+)\s*(.*)$/;g.prototype.tag="div";g.prototype.delegateEvents=function(){var b,a,f,c,d,e;d=this.events;e=[];for(a in d){c=d[a];if(typeof c!=="function")c=this.proxy(this[c]);f=a.match(this.eventSplitter);b=f[1];f=f[2];f===""?e.push(this.el.bind(b,
c)):e.push(this.el.delegate(f,b,c))}return e};g.prototype.refreshElements=function(){var b,a,f,c;f=this.elements;c=[];for(b in f){a=f[b];c.push(this[a]=this.el.find(b))}return c};g.prototype.destroy=function(){this.trigger("release");this.el.remove();return this.unbind()};return g}(Monocle.Module)}).call(this);(function(){var m={}.hasOwnProperty,l=function(h,g){function b(){this.constructor=h}for(var a in g)if(m.call(g,a))h[a]=g[a];b.prototype=g.prototype;h.prototype=new b;h.__super__=g.prototype;return h},i=[].slice;Monocle.View=function(h){function g(){g.__super__.constructor.apply(this,arguments);if(!this.template)this.template=this.constructor.template;this.template||this._loadTemplateFrom(this.template_url);if(!this.container)this.container=this.constructor.container;this.container=Monocle.Dom(this.container);
this.container.attr("data-monocle",this.constructor.name)}l(g,h);g.container=void 0;g.template_uri=void 0;g.template=void 0;g.model=void 0;g.prototype.html=function(){var b;b=1<=arguments.length?i.call(arguments,0):[];return this._html.apply(this,["html"].concat(i.call(b)))};g.prototype.append=function(){var b;b=1<=arguments.length?i.call(arguments,0):[];return this._html.apply(this,["append"].concat(i.call(b)))};g.prototype.prepend=function(){var b;b=1<=arguments.length?i.call(arguments,0):[];return this._html.apply(this,
["prepend"].concat(i.call(b)))};g.prototype.remove=function(){this.model.destroy();return this.el.remove()};g.prototype.replace=function(b){var a;a=[this.el,Monocle.Dom(b.el||b)];b=a[0];this.el=a[1];b.replaceWith(this.el[0]);this.delegateEvents(this.events);this.refreshElements();return this.el};g.prototype.refresh=function(){return this.replace(Monocle.templayed(this.template)(this.model))};g.prototype._html=function(){var b,a,f;f=arguments[0];a=2<=arguments.length?i.call(arguments,1):[];a=function(){var c,
d,e;e=[];c=0;for(d=a.length;c<d;c++){b=a[c];e.push(b.el||b)}return e}();this.replace(Monocle.templayed(this.template).apply(null,a));this.container[f](this.el[0]);return this};g.prototype._loadTemplateFrom=function(b){var a,f;a=this.constructor.name;if(!Monocle.Templates[a]){f=typeof $$!=="undefined"&&$$!==null?$$:$;b=f.ajax({url:b,async:false,dataType:"text",error:function(){return console.error(arguments)}});if(typeof $$==="undefined"||$$===null)b=b.responseText;Monocle.Templates[a]=b}return this.template=
Monocle.Templates[a]};return g}(Monocle.Controller)}).call(this);(function(){Monocle.templayed=function(m){var l,i,h,g;i=function(b,a){var f,c,d;a=1;b=b.replace(/\.\.\//g,function(){a++;return""});c=["data[data.length - ",a,"]"];d=b==="."?[]:b.split(".");for(f=0;f<d.length;){c.push("."+d[f]);f++}return c.join("")};g=function(b){return b.replace(/\{\{(!|&|\{)?\s*(.*?)\s*}}+/g,function(a,f,c){if(f==="!")return"";a=h++;return['"; var o',a," = ",i(c),", s",a," = (((typeof(o",a,') == "function" ? o',a,".call(data[data.length - 1]) : o",a,') || "") + ""); s += ',f?"s"+
a:'(/[&"><]/.test(s'+a+") ? s"+a+'.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/>/g,"&gt;").replace(/</g,"&lt;") : s'+a+")",' + "'].join("")})};l=function(b){return g(b.replace(/\{\{(\^|#)(.*?)}}(.*?)\{\{\/\2}}/g,function(a,f,c,d){a=h++;return['"; var o',a," = ",i(c),"; ",(f==="^"?["if ((o",a," instanceof Array) ? !o",a,".length : !o",a,') { s += "',l(d),'"; } ']:["if (typeof(o",a,') == "boolean" && o',a,') { s += "',l(d),'"; } else if (o',a,") { for (var i",a," = 0; i",a," < o",a,".length; i",
a,"++) { data.push(o",a,"[i",a,']); s += "',l(d),'"; data.pop(); }}']).join(""),'; s += "'].join("")}))};h=0;return new Function("data",'data = [data], s = "'+l(m.replace(/"/g,'\\"').replace(/\n/g,"\\n"))+'"; return s;')}}).call(this);
